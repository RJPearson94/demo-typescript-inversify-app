name: Node CI

on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1

      - name: Use Node.js 12.x
        uses: actions/setup-node@v1
        with:
          node-version: 12.x

      - name: install
        run: yarn install

      - name: lint
        run: yarn lint .

      # Core
      - name: Run Core Unit tests
        run: |
          cd packages/core
          yarn test:unit

      - name: Build Core artefact
        run: |
          cd packages/core
          yarn build

      # Lambda
      - name: Run Lambda Unit tests
        run: |
          cd packages/lambda
          yarn test:unit

      - name: Build Lambda artefact
        run: |
          cd packages/lambda
          yarn build

      # Wen App
      - name: Run Web App Unit tests
        run: |
          cd packages/web-app
          yarn test:unit

      - name: Build Web App artefact
        run: |
          cd packages/web-app
          yarn build
